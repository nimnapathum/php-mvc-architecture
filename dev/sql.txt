CREATE DATABASE practical_app;

CREATE TABLE Users(
    id INT AUTO_INCREMENT,
    profile_image VARCHAR(255),
    name VARCHAR(255),
    email VARCHAR(255),
    password VARCHAR(255),
    create_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY(id)
);

CREATE TABLE Post(
    id INT AUTO_INCREMENT,
    user_id INT,
    image VARCHAR(255),
    title VARCHAR(255),
    body TEXT,
    likes INT,
    dislikes INT,
    views INT,
    create_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY(id),
    FOREIGN KEY (user_id) REFERENCES Users(id) ON DELETE CASCADE
);

CREATE VIEW v_posts AS 
    SELECT 
    post.id AS post_id,
    users.id AS user_id,
    users.profile_image as profile_image,
    users.name AS user_name,
    post.image AS image,
    post.title AS title,
    post.body AS body,
    post.likes AS likes,
    post.dislikes AS dislikes,
    post.views AS views,
    post.create_at AS post_create_at,
    users.create_at AS user_create_at
    FROM post INNER JOIN users
    ON post.user_id = users.id
    ORDER BY post.create_at DESC;